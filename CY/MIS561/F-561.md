# Cybersecurity Fundamentals — Expanded Study Guide (Exam Ready, Deep Dive)

> This expanded guide elaborates every definition and topic from the original "Exam Ready" study guide.  
> It adds concrete examples, technical detail, command usage, common pitfalls, and practice items.  
> Use this as a learning companion or revision reference.

---

# 1. Cybersecurity Fundamentals — Deep Dive

**Core goals of cybersecurity**  
Cybersecurity's primary mission is to protect data and systems across multiple dimensions:

- **Confidentiality** — Ensuring information is accessible only to authorized parties. Techniques: access controls (ACLs), encryption at rest and in transit, proper key management, and least-privilege design.
  - Example: Encrypting a database with AES-256 ensures stored sensitive fields cannot be read without the key.

- **Integrity** — Ensuring data has not been altered in an unauthorized way. Techniques: cryptographic hashing (SHA family), digital signatures, checksums, and immutability controls.
  - Example: A file's SHA-256 hash stored in a signed manifest allows detection of tampering.

- **Availability** — Ensuring systems and data are accessible when needed. Techniques: redundancy, load balancing, DDoS protection, backups, and monitoring/alerting.
  - Example: Using multiple geographically-distributed web servers behind a load balancer to survive a data center outage.

**Expanded CIAAAN**
- **Authenticity** — Verifying identity of entities (users, certificates, services). Often provided by PKI, digital certificates, multi-factor authentication (MFA).
- **Accountability** — Being able to trace actions to a responsible party via auditing, secure logging (append-only, tamper-evident), and identity systems.
- **Non-repudiation** — Ensuring a party cannot deny actions they performed (digital signatures, signed audit logs).

**Threat actors & capabilities**
- **Nation-states (APT)**: Advanced Persistent Threats (APTs) use zero-days, supply-chain compromises, and long-term infiltration. Objectives: espionage, sabotage.
- **Cybercriminals**: Monetize access through ransomware, fraud, data theft. Use phishing, commodity malware, and botnets.
- **Hacktivists**: Motivated by political or social causes; often defacement, DDoS, or data leaks.
- **Insiders**: Trusted users who may act maliciously or negligently. Controls: least privilege, monitoring, separation of duties.

**Common attack vectors**
- **Phishing & social engineering**: Exploit human trust. Highly effective; training + email defenses (DKIM/DMARC/SPF) mitigate risk.
- **Software vulnerabilities**: Unpatched systems, misconfigurations, insecure defaults. Use vulnerability management and patching cadence.
- **Network attacks**: Man-in-the-middle, ARP poisoning, DNS spoofing.
- **Supply chain**: Compromise a vendor or third-party service to affect many downstream victims.

---

# 2. Windows & Linux Command Line Essentials — Practical usage

Below are commands with typical flags, expected output, and how to use them for troubleshooting.

## Windows
- `ipconfig /all`  
  - Shows all adapters, MACs, DNS servers, DHCP status, lease times. Use when verifying DHCP allocations.
- `ping -n 10 example.com`  
  - Send 10 ICMP requests; useful to measure packet loss and latency.
- `tracert example.com`  
  - Shows each hop and latency. Helpful to locate where a route fails.
- `nslookup example.com`  
  - Interactively query DNS records. Can point to a specific DNS server: `nslookup example.com 8.8.8.8`.
- `netstat -ano`  
  - Shows current TCP/UDP connections with owning PID. Useful to find which process is listening on a port.
- `tasklist /svc` and `taskkill /PID <pid> /F`  
  - Manage processes when investigating suspicious services.

## Linux
- `ip a` (or `ifconfig`)  
  - Display IP addresses and interface state. `ip -s link` shows packet statistics for troubleshooting.
- `ping -c 5 example.com`  
  - Send 5 pings.
- `traceroute example.com`  
  - Path discovery. Requires `sudo` for certain probing.
- `dig example.com ANY` or `dig +short example.com`  
  - More flexible DNS queries than `nslookup`. Example: `dig MX example.com`.
- `ss -tuln` or `netstat -tuln`  
  - Show listening sockets for TCP/UDP. Use to check open ports.
- `sudo` — run commands as root. Use `sudo -l` to list permitted commands. Least-privilege practice: avoid `sudo su` unless necessary.
  
  - `ls -l filename`  
    - Shows detailed file information including permissions, ownership, size, and modification date. Permissions are displayed as `-rwxr-xr--` where the first character indicates file type (`-` regular file, `d` directory), the next three characters are owner permissions, the middle three are group permissions, and the last three are others’ permissions.  

- `stat filename`  
  - Provides detailed file metadata, including numeric permissions (e.g., `Mode: 0644`) and timestamps (access, modify, change). Useful for precise permission checking.  

- `chmod`  
  - Change file permissions. Can use symbolic (`chmod u+x file`) or numeric (`chmod 755 file`) modes. Always verify with `ls -l` after changes.  

- `chown`  
  - Change file owner and/or group. Syntax: `chown user:group file`. Use with `sudo` if not the owner.  


**Practice exercise:** On your lab VM, run `ss -tuln` and map open ports to expected services. If a port is unexpected, investigate the binary owning it (`lsof -i :<port>`).

---

# 3. Networking Foundations — Devices & behaviors

**Device behaviors (expanded):**
- **Hub (Layer 1)**: Repeats electrical signal to all ports — no frame filtering. Risk: broadcast domain expansion, no isolation.
- **Switch (Layer 2)**: Learns MAC addresses and forwards frames only out the destination port. Switches implement CAM tables and support VLANs on managed models.
- **Router (Layer 3)**: Forwards IP packets between subnets based on routing tables. Applies ACLs and performs NAT.
- **Firewall**: Can operate at multiple layers. NGFWs inspect application payloads (L7), do TLS inspection, and enforce security policies.

**VLANs and segmentation**
- VLANs partition a switch into logical networks — reduce broadcast domains and limit attack surface.
- Example: Separate guest Wi‑Fi on VLAN 30, internal users on VLAN 10, servers on VLAN 20. Apply ACLs on routers/firewalls to control cross-VLAN traffic.

**Managed vs Unmanaged switch**
- Managed switches provide:
  - VLAN configuration
  - SNMP for monitoring
  - Port security (limit MACs per port)
  - Spanning Tree Protocol (STP) configuration
- Unmanaged are for simple, small deployments — no policy controls.

---

# 4. OSI Model — Functions, data units, and real-world mapping

Layer-by-layer with practical relevance:

1. **Physical (Layer 1)** — Electrical/optical signals. Problems: bad cables, duplex mismatch, interference. Tools: cable testers, SFP swaps.
2. **Data Link (Layer 2)** — MAC addressing, switches, ARP. Data unit: **frame**. Security concerns: MAC spoofing, VLAN hopping.
3. **Network (Layer 3)** — IP routing, fragmentation, routing protocols (OSPF, BGP). Data unit: **packet**.
4. **Transport (Layer 4)** — TCP/UDP, ports, segmentation, reassembly. Data unit: **segment** or **datagram**.
5. **Session (Layer 5)** — Session establishment/teardown, often implemented inside application stacks (e.g., TLS handshake sessions).
6. **Presentation (Layer 6)** — Translation, encryption/decryption, compression (e.g., TLS, character encoding).
7. **Application (Layer 7)** — Protocols and services (HTTP, SMTP, DNS). Attacks at L7 often involve malformed requests or application logic flaws.

**Real-world mapping:** A malicious HTTP (L7) request traverses all lower layers; network detection may occur at L3/L4 (IPS) or L7 (WAF).

---

# 5. TCP/IP, Addressing, and Subnetting — Worked examples

## IPv4 vs IPv6 — technical notes
- **IPv4**: 32-bit, ~4.3 billion addresses. Uses subnet masks or CIDR notation. NAT commonly used due to scarcity.
- **IPv6**: 128-bit, massively larger address space, simplified header, mandatory support for IPsec (in specification), built-in autoconfiguration (SLAAC), and elimination of NAT as a design assumption.

## Subnetting — worked example
Given network `192.168.100.0/24`, you need 4 subnets of roughly equal size.

- `/24` has 256 addresses (254 usable). Split into `/26` subnets (each /26 = 64 addresses, 62 usable).
- Subnets:
  - 192.168.100.0/26 → hosts .1–.62
  - 192.168.100.64/26 → hosts .65–.126
  - 192.168.100.128/26 → hosts .129–.190
  - 192.168.100.192/26 → hosts .193–.254

**Practice:** Convert between netmask and CIDR using bit counts. Example mask `255.255.255.240` → `/28` (16 addresses, 14 usable).

## Localhost and loopback testing
- IPv4 loopback: `127.0.0.1` — used to test local network stack.
- IPv6 loopback: `::1`

**NAT types**:
- **Static NAT**: 1:1 mapping public to private IP.
- **PAT (Port Address Translation)**: Many-to-one mapping using ports (common home router behavior).

---

# 6. DNS, ARP, NAT, DHCP — Mechanics and security considerations

## DNS — detailed flow
1. Application asks OS resolver (via glibc resolver or native API).
2. Local resolver/cache checked.
3. If not cached: iterative or recursive query to upstream DNS resolver.
4. Resolver queries root servers → TLD servers → authoritative name servers.
5. Response cached with TTL.

**Security threats & mitigations**
- **DNS spoofing/cache poisoning** — mitigated by DNSSEC (signing records) and use of randomized source ports and query IDs.
- **DNS over HTTPS (DoH) / DNS over TLS (DoT)** — encrypts DNS queries, improving privacy but raising enterprise monitoring challenges.

## ARP — specifics & attacks
- **ARP request**: "Who has 192.168.1.10? Tell 192.168.1.1"
- **ARP reply**: "192.168.1.10 is at aa:bb:cc:dd:ee:ff"
- **ARP poisoning**: Attacker sends forged replies mapping an IP to their MAC. Mitigations: static ARP entries, dynamic ARP inspection (switch feature), and using encrypted tunnels.

## DHCP — how leases work
- **DORA**: Discover → Offer → Request → Acknowledge. DHCP server assigns lease with expiry; clients must renew.
- **DHCP attacks**: Rogue DHCP servers can give malicious gateway/DNS; mitigate with DHCP snooping and port security.

## NAT security considerations
- NAT hides internal IPs but is not a security control. Combine NAT with firewall policies. Remember certain protocols (FTP active mode) require ALG or helper for proper NAT traversal.

---

# 7. Ports, Protocols, TCP vs UDP, Handshake — deeper

## TCP reliability mechanisms
- Sequence numbers, acknowledgments, retransmissions, flow control (window size), congestion control (slow-start, congestion avoidance).
- **Three-way handshake** ensures both parties agree on initial sequence numbers. A SYN flood attack abuses this by sending many SYNs without completing the handshake — mitigated by SYN cookies or connection rate-limiting.

## UDP characteristics
- Lightweight, connectionless. Suitable for real-time apps (VoIP, DNS). Because it's stateless, it's vulnerable to spoofing and amplification attacks (e.g., DNS amplification DDoS).

## Ports and services — tip
- Well-known ports (0–1023) often require elevated privileges to bind. Common services and variations:
  - HTTP: 80 (cleartext) — use HTTPS (443)
  - HTTPS: 443 — uses TLS; know how to inspect cert chains and validate CA trust

---

# 8. Firewalls & Network Security — design and rule hygiene

## Types & evolution
- **Packet filters**: Fast, simple, based on IP/port. Insufficient alone for modern threats.
- **Stateful firewalls**: Track connection state (SYN, ESTABLISHED). More context-aware.
- **NGFW**: Integrates application awareness, user identity, intrusion prevention, and TLS inspection.
- **WAF (Web Application Firewall)**: Rules tailored to HTTP(S) traffic to block SQLi, XSS, and malicious payloads.

## Best practices
- Default deny (deny all, permit by exception).
- Principle of least privilege for egress and ingress.
- Rule ordering: highly specific rules first; avoid overlapping rules that cause surprises.
- Log and monitor denied/allowed traffic — align with SIEM ingestion.

## HIDS vs NIDS
- **HIDS (Host-based)**: Runs on the host, inspects file integrity, logs, and processes (e.g., OSSEC, Wazuh).
- **NIDS (Network-based)**: Monitors network traffic (e.g., Snort, Suricata).
- **Efficacy**: Use both for defense-in-depth.

---

# 9. Risk, Threats, Malware, and Attacks — calculations & case studies

## Risk calculation — formulas and example
- **Asset Value (AV)** — estimated monetary or business value.
- **Exposure Factor (EF)** — percentage loss if a specific threat materializes.
- **Single Loss Expectancy (SLE)**: $$\text{SLE} = \text{AV} \times \text{EF}$$
- **Annualized Rate of Occurrence (ARO)** — expected frequency per year.
- **Annual Loss Expectancy (ALE)**: $$\text{ALE} = \text{SLE} \times \text{ARO}$$

**Example:** AV = \$500,000, EF = 0.1 (10% loss), ARO = 0.2 (once every 5 years)
- SLE = \$500,000 × 0.1 = \$50,000
- ALE = \$50,000 × 0.2 = \$10,000/year

## Malware families — behaviors and detection
- **Virus** — needs host file to propagate. Detection: antivirus signatures, behavior-based detection.
- **Worm** — self-replicates across networks (e.g., WannaCry exploited SMB).
- **Trojan** — hides malicious payload behind benign functionality.
- **Ransomware** — encrypts data and demands payment; countermeasures: offline backups, endpoint protections, restrict admin privileges.
- **Rootkit** — hides presence by tampering with OS kernel—difficult to detect; often requires full reimage.

## Social engineering — a layered defense
Controls:
- User awareness training with phishing simulations.
- Technical controls: email filtering (attachment sandboxing), URL rewriting, attachment detonation.
- Process controls: verification of wire transfer requests with out-of-band confirmation.

## DoS/DDoS — mitigation
- Upstream scrubbing (cloud DDoS protection), rate limiting, anycast load balancing.

---

# 10. Cryptography Fundamentals — math, practice, and PKI

## Symmetric cryptography
- Algorithms: AES (block cipher), ChaCha20.
- Modes of operation: CBC, GCM (authenticated), CTR.
- Key distribution problem: how do two parties share the symmetric key? Use asymmetric methods or pre-shared secure channels.

## Asymmetric cryptography
- RSA, ECC (elliptic curve cryptography). Asymmetric keys are longer/slower but enable secure key exchange and digital signatures.
- **Use case**: TLS handshake typically uses asymmetric crypto to establish a shared symmetric session key for bulk encryption.

## Hashing vs Encryption
- **Hash**: One-way function. Common hashes: SHA-256, SHA-3. Use salts for password hashing and prefer slow functions for passwords (bcrypt, scrypt, Argon2).
- **Encryption**: Reversible with the correct key. Example: AES-GCM provides confidentiality and integrity (authenticated encryption).

## Digital signatures & non-repudiation
- Sign with private key; verify with public key. Certificates from a CA bind identity to keys. Understand certificate chain and trust anchors.

## Practical PKI notes
- Certificate Revocation: CRLs and OCSP. Expectation: certificate invalidation after compromise.
- TLS: Be familiar with cipher suite negotiation, forward secrecy (using ephemeral Diffie-Hellman), and how weak suites (e.g., RSA key exchange without ephemeral keys) can harm security.

---

# 11. Vulnerabilities, Scanning, Tools, and Testing — safe practice

## Vulnerability lifecycle
- Discovery → CVE assignment → Patches/mitigations → Exploit development.
- **Responsible disclosure**: Follow vendor policies and use coordinated disclosure where appropriate.

## Tools overview
- **Nessus**, **OpenVAS**: Vulnerability scanners. Use credentialed scans for better coverage; treat findings critically (false positives).
- **Burp Suite**: Intercepting proxy for web app security testing. Useful functionalities: intruder, repeater, scanner (Pro).
- **Metasploit**: Exploitation framework — use in authorized lab environments only.

## IDS/IPS workings
- Signature-based detection: fast but can be evaded by obfuscation.
- Anomaly-based detection: profile baselines; can detect novel attacks but produce more false positives.

## Pen-testing basics and ethics
- Authorization: always have written permission.
- Scope: define systems, time window, and allowed techniques.
- Reporting: prioritize findings by risk, include reproducible steps, and remediation advice.

---

# 12. Physical & Administrative Security — controls & examples

## Physical controls
- **Mantraps**: two-door entry systems to prevent tailgating.
- **CCTV, biometrics, keycards**: combine for layered control.
- **Environmental**: fire suppression, HVAC, power redundancy (UPS, generators).

## Administrative controls
- Policies, procedures, background checks, training.
- **Separation of duties**: prevents fraud by dividing critical tasks (developer vs deployer).
- **Job rotation**: reduces insider risk by rotating responsibilities and creating knowledge overlap.

## Fraud triangle — prevention
- Opportunity, pressure, rationalization. Controls reduce opportunity (access controls), and provide detection to reduce rationalization.

---

# 13. Backups, Availability Metrics, and Recovery — practical guidelines

## Backup strategies
- **Full backup**: Copies everything. Fastest recovery, slowest and largest backup size.
- **Differential**: Back up data changed since last full backup. Faster than full for storage, but restoration requires full + latest differential.
- **Incremental**: Only back up changes since last backup (full or incremental). Smallest backups, restore requires full + all incrementals.

**3-2-1 rule:** Keep at least three copies of data, on two different media, and one copy offsite.

## Availability metrics
- **MTTF** (Mean Time To Failure) — average operational time before failure (non-repairable items).
- **MTBF** (Mean Time Between Failures) — average time between failures for repairable systems.
- **MTTR** (Mean Time To Repair) — average time to restore after failure.

## RPO & RTO
- **Recovery Point Objective (RPO)**: maximum tolerable data loss (e.g., RPO = 1 hour).
- **Recovery Time Objective (RTO)**: maximum tolerable downtime (e.g., RTO = 4 hours).
Map backup cadence to meet RPO, and design recovery playbooks to meet RTO.

---

# 14. Web, Email, and Application Security — common flaws & defenses

## Web app threats
- **SQL Injection (SQLi)**: Malicious input alters SQL queries. Mitigations: parameterized queries / prepared statements, ORM usage, input validation, least privilege DB accounts.
- **Cross-Site Scripting (XSS)**: Injected client-side scripts. Mitigate with output encoding, Content Security Policy (CSP).
- **CSRF**: Cross-site request forgery — mitigate with anti-CSRF tokens and same-site cookies.

## Secure design principles
- Validate input, encode output, use secure defaults, fail securely, avoid meaningful error messages leaking internal state.
- Use secure auth flows: implement multi-factor authentication and rotate credentials.

## Email security
- **SPF**: Sender Policy Framework — publish authorized sending IPs.
- **DKIM**: DomainKeys Identified Mail — sign outbound mail.
- **DMARC**: Policy to instruct receivers how to treat unauthenticated mail.
- Protect attachments: block executables, use sandboxing.

---

# 15. Dark Web, Cookies, Attack Surfaces, and Password Attacks — defensive steps

## Web layers
- **Surface web**: indexed by search engines.
- **Deep web**: not indexed (e.g., private databases).
- **Dark web**: overlay networks (Tor) used for anonymity; illicit markets and data dumps common here.

## Attack surface reduction
- Minimize exposed services, keep software updated, implement network segmentation, and use host-based hardening (remove unnecessary services).

## Cookie security
- Flags: `HttpOnly`, `Secure`, `SameSite=strict`/`lax` to reduce XSS and CSRF vectors.
- Session management: rotate session cookies after elevation, expire sessions appropriately, and store minimal sensitive info in cookies.

## Password attacks
- **Dictionary**: using common words. Mitigation: enforce strong password policies and check against breached-password lists.
- **Brute force**: try all combinations; mitigated with account lockout, exponential backoff, and CAPTCHAs.
- **Hybrid / combinatorial**: mixes dictionary words with numbers/symbols.
- **Password hashing**: always store passwords salted + hashed with slow KDF (Argon2 recommended).

---

# Appendix — Quick reference commands & formulas

## Risk formulas

$$\text{SLE} = \text{AV} \times \text{EF}$$

$$\text{ALE} = \text{SLE} \times \text{ARO}$$

## Useful Linux commands
```
ip a
ss -tuln
dig +short example.com
sudo journalctl -u nginx.service
```

## Useful Windows commands
```
ipconfig /all
netstat -ano
tracert example.com
Get-EventLog -LogName System -Newest 50   # PowerShell
```

---
